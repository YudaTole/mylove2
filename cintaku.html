<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Love Slideshow — Typewriter</title>
<style>
  :root{ --accent:#ff6aa2; --accent2:#ff9bd1; }
  html,body{height:100%;margin:0;background:#0a0a0a;color:#fff;font-family:system-ui,Segoe UI,Roboto,Inter,Arial;overflow:hidden}
  .app{position:relative;width:100%;height:100vh;overflow:hidden}

  /* Latar foto + crossfade + Ken Burns */
  .layer{position:absolute;inset:0;background-size:cover;background-position:center;
         transition:opacity 1100ms ease, transform 7s ease;filter:saturate(1.04) contrast(1.02)}
  .layer.dim{opacity:0}
  .vignette{position:absolute;inset:0;pointer-events:none;background:
    radial-gradient(1400px 650px at 50% 70%, rgba(0,0,0,0), rgba(0,0,0,.55) 60%, rgba(0,0,0,.78))}

  /* Box quote */
  .quote{position:absolute;left:50%;bottom:12vh;transform:translateX(-50%);
    width:min(92vw,900px);text-align:center;z-index:6;padding:16px 20px;border-radius:18px;
    background:linear-gradient(to bottom, rgba(255,255,255,.12), rgba(255,255,255,.06));
    backdrop-filter:blur(6px);box-shadow:0 10px 30px rgba(0,0,0,.35);opacity:0;transition:opacity .4s ease}
  .quote.show{opacity:1}
  .quote p{margin:0;min-height:2.4em;font-size:clamp(18px,3.3vw,30px);line-height:1.38}
  .quote .by{margin-top:10px;font-size:clamp(12px,2vw,16px);opacity:.9}

  /* Kursor kedip untuk typewriter */
  .caret{display:inline-block;width:1ch}
  .caret::after{content:"";display:inline-block;width:2px;height:1em;background:#fff;margin-left:3px;
    animation:blink 1s step-end infinite}
  @keyframes blink{50%{opacity:0}}

  /* Hati melayang */
  .hearts{position:absolute;inset:0;pointer-events:none;overflow:hidden;z-index:5}
  .heart{position:absolute;bottom:-40px;font-size:16px;opacity:.95;animation:floatUp linear forwards}
  @keyframes floatUp{to{transform:translateY(-120vh) translateX(var(--drift,0px));opacity:0}}

  /* Intro + tombol play */
  .intro{position:absolute;inset:0;display:grid;place-items:center;z-index:10;background:#000;transition:opacity .7s ease}
  .intro.hide{opacity:0;pointer-events:none}
  .intro-inner{display:flex;flex-direction:column;align-items:center;gap:18px}
  .play-btn{--s:110px;width:var(--s);height:var(--s);border-radius:999px;display:grid;place-items:center;cursor:pointer;
    background:conic-gradient(from 210deg,var(--accent),var(--accent2));
    box-shadow:0 10px 40px rgba(255,106,162,.55), inset 0 0 0 6px rgba(255,255,255,.16);transition:transform .15s ease}
  .play-btn:hover{transform:scale(1.04)}
  .play-icon{width:44%;aspect-ratio:1/1;margin-left:6px;fill:white}
  .hint{font-size:14px;opacity:.8}
  .brand{position:absolute;top:14px;left:50%;transform:translateX(-50%);z-index:7;font-size:13px;opacity:.9}

  @media (max-width:520px){ .quote{bottom:10vh;padding:12px 14px} }
</style>
</head>
<body>
<div class="app">
  <div class="layer" id="layerA" aria-hidden="true"></div>
  <div class="layer dim" id="layerB" aria-hidden="true"></div>
  <div class="vignette" aria-hidden="true"></div>

  <div class="quote" id="quoteBox">
    <p id="quoteText"></p>
    <div class="by" id="quoteBy"></div>
  </div>

  <div class="hearts" id="hearts"></div>

  <div class="intro" id="intro">
    <div class="intro-inner">
      <div style="font-size:clamp(18px,3.6vw,28px);opacity:.92">Untuk kamu…</div>
      <div class="play-btn" id="playBtn" aria-label="Mulai">
        <svg class="play-icon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
      </div>
      <div class="hint">Sentuh tombol untuk memulai musik & slideshow</div>
    </div>
  </div>

  <div class="brand">Love Gallery — Typewriter</div>
  <audio id="bgm" preload="auto" loop></audio>
</div>

<script>
/* =============== KONFIGURASI =============== */
const MUSIC_URL = "https://files.catbox.moe/apz92p.aac"; // ganti ke URL mp3
const IMAGES = [
  "https://images.unsplash.com/photo-1517487881594-2787fef5ebf7?q=80&w=1600&auto=format&fit=crop",
  "https://images.unsplash.com/photo-1496302662116-35cc4f36df92?q=80&w=1600&auto=format&fit=crop",
  "https://images.unsplash.com/photo-1504198453319-5ce911bafcde?q=80&w=1600&auto=format&fit=crop",
  "https://images.unsplash.com/photo-1495385794356-15371f348c31?q=80&w=1600&auto=format&fit=crop",
  "https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=1600&auto=format&fit=crop",
  "https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1600&auto=format&fit=crop",
  "https://images.unsplash.com/photo-1522335789203-aabd1fc54bc9?q=80&w=1600&auto=format&fit=crop",
  "https://images.unsplash.com/photo-1492562080023-ab3db95bfbce?q=80&w=1600&auto=format&fit=crop",
  "https://images.unsplash.com/photo-1499084732479-de2c02d45fc4?q=80&w=1600&auto=format&fit=crop",
  "https://images.unsplash.com/photo-1487412720507-7b1db5f4f2b2?q=80&w=1600&auto=format&fit=crop"
]; // ganti ke URL fotomu (10 item)

const QUOTES = [
  { text: "Aku mencintaimu bukan karena siapa kamu, tetapi karena siapa diriku saat bersamamu.", by: "— Roy Croft" },
  { text: "Di matamu, aku menemukan rumah. Di hatimu, aku menemukan damai.", by: "— Unknown" },
  { text: "Cinta adalah janji: sekali diberi, tak akan pernah dilupakan.", by: "— John Lennon" },
  { text: "Kau tidak hanya mengisi hari-hariku—kau melengkapi hidupku.", by: "— Unknown" },
  { text: "Bahagia itu sederhana: mendengar suaramu dan melihatmu tersenyum.", by: "— Unknown" },
  { text: "Kau adalah paragraf favorit di setiap bab hidupku.", by: "— Unknown" },
  { text: "Dalam semesta kemungkinan, aku tetap memilih kamu.", by: "— Unknown" },
  { text: "Cinta yang dewasa bukan tentang memiliki, tetapi menjaga dan bertumbuh bersama.", by: "— Unknown" },
  { text: "Bersamamu, jam terasa menit; jauh darimu, menit terasa jam.", by: "— Unknown" },
  { text: "Genggamlah tanganku; mari kita pulang—ke kita.", by: "— Unknown" }
];

const TYPE_SPEED = 40;          // ms per huruf (semakin kecil semakin cepat)
const AFTER_TYPE_HOLD = 1200;   // jeda setelah ketikan selesai sebelum ganti slide
const KEN_BURNS_MIN = 1.00, KEN_BURNS_MAX = 1.08; // zoom pelan
/* ============================================ */

/* Elemen */
const layerA = document.getElementById('layerA');
const layerB = document.getElementById('layerB');
const quoteBox = document.getElementById('quoteBox');
const quoteText = document.getElementById('quoteText');
const quoteBy = document.getElementById('quoteBy');
const intro = document.getElementById('intro');
const playBtn = document.getElementById('playBtn');
const audio = document.getElementById('bgm');
const hearts = document.getElementById('hearts');

/* State */
let idx = 0, onA = true, started = false;
audio.src = MUSIC_URL;

/* Preload gambar */
IMAGES.forEach(src=>{ const i = new Image(); i.src = src; });

/* Utils */
const wait = ms => new Promise(r=>setTimeout(r, ms));

/* Typewriter */
async function typeText(el, text){
  el.innerHTML = "";
  const caret = document.createElement("span");
  caret.className = "caret";
  el.appendChild(caret);
  for(let i=0;i<text.length;i++){
    caret.insertAdjacentText("beforebegin", text[i]);
    await wait(TYPE_SPEED);
  }
  caret.remove();
}

/* Slideshow  — pakai chain (bukan setInterval) agar menunggu ketikan selesai */
async function showSlide(i){
  const url = IMAGES[i % IMAGES.length];
  const q = QUOTES[i % QUOTES.length] || {text:"", by:""};

  // ganti layer + ken burns
  const scale = onA ? KEN_BURNS_MAX : KEN_BURNS_MIN;
  if(onA){
    layerB.style.backgroundImage = `url('${url}')`;
    layerB.style.transform = `scale(${scale})`;
    layerA.classList.add('dim'); layerB.classList.remove('dim');
  }else{
    layerA.style.backgroundImage = `url('${url}')`;
    layerA.style.transform = `scale(${scale})`;
    layerB.classList.add('dim'); layerA.classList.remove('dim');
  }
  onA = !onA;

  // ketik quote
  quoteBox.classList.remove('show');
  await wait(220); // sinkron sedikit dgn crossfade
  await typeText(quoteText, q.text);
  quoteBy.textContent = q.by || "";
  quoteBox.classList.add('show');

  // jeda setelah ketikan
  await wait(AFTER_TYPE_HOLD);
}

/* Loop slideshow */
async function startShow(){
  if(started) return; started = true;
  while(true){
    await showSlide(idx++);
  }
}

/* Musik dengan fade-in lembut */
async function playMusicWithFade(){
  try{ audio.volume = 0; await audio.play(); }catch(e){ console.warn("Autoplay ditolak:", e); }
  const dur = 2000, steps = 20, step = dur/steps;
  for(let s=1;s<=steps;s++){ audio.volume = s/steps; await wait(step); }
}

/* Hearts */
function spawnHearts(){
  const EMO = ['❤️','💖','💕','💗'];
  setInterval(()=>{
    const h = document.createElement('div');
    h.className='heart'; h.textContent = EMO[Math.floor(Math.random()*EMO.length)];
    h.style.left = (Math.random()*100)+'vw';
    h.style.fontSize = (14+Math.random()*22)+'px';
    const dur = 5000 + Math.random()*6000;
    h.style.animationDuration = dur+'ms';
    h.style.setProperty('--drift', (-40+Math.random()*80)+'px');
    hearts.appendChild(h);
    setTimeout(()=>h.remove(), dur);
  }, 700);
}

/* Event start */
playBtn.addEventListener('click', async ()=>{
  await playMusicWithFade();
  intro.classList.add('hide');
  spawnHearts();
  startShow();
});
intro.addEventListener('click', async (e)=>{
  if(e.target === intro){ // klik area gelap
    await playMusicWithFade();
    intro.classList.add('hide');
    spawnHearts();
    startShow();
  }
});

/* Bootstrap first frame (biar nggak gelap sebelum play) */
(function boot(){
  layerA.style.backgroundImage = `url('${IMAGES[0]}')`;
  layerA.style.transform = `scale(${KEN_BURNS_MIN})`;
})();
</script>
</body>
</html>
